<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:decorate xmlns="http://www.w3.org/1999/xhtml"
             xmlns:h="http://xmlns.jcp.org/jsf/html"
             xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
             template="../template.xhtml"
             xmlns:f="http://xmlns.jcp.org/jsf/core">
    
    <div class="container">
        <br />
        <h:messages />
        
        <h1>
            Clientes 
            <h:link title="Adicionar cliente" outcome="new">
                <i class="fa fa-plus fa-3"></i>
            </h:link>
        </h1>
        
        <h:form>
            <h:dataTable class="table table-striped" value="#{clienteMB.clientes}" var="cliente">
                <h:column>
                    <f:facet name="header">
                        Cliente
                    </f:facet>
                    
                    #{cliente.nomeCompleto}
                </h:column>
                <h:column>
                    <f:facet name="header">
                        CPF
                    </f:facet>
                    
                    #{cliente.cpf}
                </h:column>
                <h:column>
                    <f:facet name="header">
                        Ações
                    </f:facet>
                    
                    <h:link
                        type="button"
                        class="btn btn-primary icon-button"
                        title="Editar"
                        outcome="edit"
                    >
                        <i class="fas fa-edit"></i>
                        
                        <f:param name="id" value="#{cliente.id}" />
                    </h:link>
                    
                    <h:commandLink
                        action="#{clienteMB.setCliente(cliente.id)}"
                        type="button"
                        class="btn btn-danger icon-button"
                        title="Excluir"
                        style="margin-left: 10px;"
                    >
                        <i class="fas fa-trash-alt"></i>
                        
                        <f:passThroughAttribute name="data-toggle" value="modal" />
                        <f:passThroughAttribute name="data-target" value="#deleteClientModal" />
                        
                        <f:ajax render="deleteClientModalForm" />
                    </h:commandLink>
                </h:column>
            </h:dataTable>
        </h:form>
    </div>
    
    <!-- Modal -->
    <div class="modal fade" id="deleteClientModal" tabindex="-1" aria-labelledby="deleteClientModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteClientModalLabel">Excluir Cliente</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <h:form id="deleteClientModalForm" role="form">
                    <div class="modal-body" style="text-align: center;">
                        <div class="form-group">
                            <p>Você deseja excluir o cliente 
                                <b><span>#{clienteMB.cliente.nomeCompleto}</span></b>?
                                <br/><br/>
                                
                                <i class="fas fa-exclamation-triangle" style="color: red;"></i> 
                                Cuidado! Esta operação é irreversível.
                            </p>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                        
                        <h:commandButton
                            class="btn btn-primary"
                            value="Ok"
                            action="#{clienteMB.excluir}"
                        />
                    </div>
                </h:form>
            </div>
        </div>
    </div>
    
</ui:decorate>
